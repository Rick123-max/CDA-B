# MOD 12

## OSINT Techniques

### Overview of OSINT
![12354486-84e4-4401-975d-81ad1349ef53](https://github.com/user-attachments/assets/c5ee17f4-a54e-4b26-9bc9-bef4492cebd4)

- **OSINT** is gathering publicly-available data for use as intelligence in a specific operation or investigative purpose.
- Not all data that is available on the internet is OSINT.
- That data becomes OSINT when it is retrieved or applied to a specific purpose.

#### OSINT Framework
<img width="1260" height="906" alt="b5a74228-64f9-433d-94aa-19e1e9633745" src="https://github.com/user-attachments/assets/dac0b10f-4584-4a91-993e-ed5bdadfa866" />

### Online and Local Search Tools
#### _IntelligenceX
- _IntelligenceX brings several search engines and tools together under one website in an organized manner to conduct OSINT queries.
- _IntelligenceX performs searches using specific search terms (or selectors) including:
  - Email addresses
  - Domains
  - Uniform Resource Locator (URL)
  - IP
  - Classless Inter-Domain Routing (CIDR)
  - Bitcoin addresses
  - InterPlanetary File System (IPFS) hashes
- Searches occur in multiple locations such as:
  - Darknet: A form of internet overlay networks that can only be accessed with special software, settings, or authorization; often employs a custom communication protocol
  - Document sharing platforms
  - WHOIS dataPublic data leaks

#### Shodan
- Shodan is a search engine, but not for websites. It was built to search for internet-connected devices such as webcams, voice controllers, home security systems, etc.
- It can be used to search for devices using **default/generic credentials**, for **indicators of files or directories unique to a specific device**, **database**, **VoIP** product, or **webcam**.

### Social Media
#### Gramho
- Gramho analyzes Instagram accounts to provide statistics and compare it to others users.
- The predictability algorithm provides feedback on the account’s popularity.
- It also allows exploration and monitoring of user account anonymously.
- This can be used to analyze Instagram accounts and even extract the original images or videos from the accounts.
- Screenshots or screen recordings may not capture the image with full fidelity.

#### Social Bearing
- Social Bearing is intended for brand and market research, but can be used to find links, images, videos, and even geolocation on certain topics.
- Any website or application trying to access a Twitter stream or endpoint must first authenticate with the new API.
- Application and user authentication are the two forms of Twitter API authentication.
  - Both methods of authentication necessitate the use of access keys, which Twitter uses to monitor endpoint use and combat spam.
- A Twitter login is required to complete some searches using Social Bearing.
- Twitter phased out access to their old Application Programming Interface (API), which has been replaced by a new API.
  - Any website or application trying to access a Twitter stream or endpoint must first authenticate with the new API.

### DNS Data
- DNS data provides multiple types of OSINT and various tools to help you obtain it.

#### DNSDumpster
- DNSDumpster is employed to find hosts related to a desired domain.
- For an attacker’s perspective, locating visible hosts is a vital part of security assessment.
- Being able to quickly discover, map, and visualize the domain's attack surface is beneficial for OSINT.
- This may be used to discover weak points in the attack surface. Weak points may include old servers or forgotten web applications/servers
- OSINT of this type is useful to CPT members to identify terrain in mission partner systems that are exposed to the internet in unknown or unforeseen ways. 

<img width="817" height="875" alt="d9b918bb-b1cb-4d04-b1ce-1464a698f588" src="https://github.com/user-attachments/assets/7079a269-5c7f-48e9-94f8-e5e92dd91fa4" />

### Recon-ng
- Recon-ng is a reconnaissance framework designed to provide a complex environment for conducting open-source, web-based reconnaissance rapidly.
- However, Recon-ng performs web-based recon naissance  exclusively, so it is not intended to compete with Metasploit.
- This tool installs locally on a computer and runs from there, so all queries/requests are coming from the computer rather than a search engine
- The Interesting File Finder checks multiple hosts for interesting files in predictable locations.
  - An interesting file is a file containing environmental data, metadata, or configuration information not normally linked from another web page, however, it is stored in a location that is publicly accessible

### theHarvester
- theHarvester is a powerful tool for gathering OSINT.
  - Specifically, it gathers information associated with provided **names**, **emails**, **domains**, **IPs**, and **URLs** from various public data sources like **Google** or **LinkedIn**.

### TinEye
- TinEye is a reverse image search.
  - It uses **pattern recognition**, **computer vision**, **machine learning**, and **neural networks** to search for any uploaded image.
- Reverse image searches are also commonly used to identify potential spearphishing attempts, particularly over social media.

### Google Hacking
#### Google Hacking Database (GHDB)
<img width="1036" height="796" alt="9830bca2-6456-4f1f-a6c1-f59ec501355c" src="https://github.com/user-attachments/assets/ff2c49cc-3160-4219-8da6-7796509a48a0" />

- GHDB is a repository of search filters used on Google (and other search engines) to search for interesting and/or sensitive information
- It is hosted on Offensive Security’s Exploit Database website
-_ Google dorking_ uses the Google search engine’s innate abilities to locate various file types and webpages using specific search strings.
  - A device that is connected to the internet is all that is required to execute these searches.

### Data Visualization
#### OSINT Combine
<img width="1279" height="828" alt="83299638-e80c-4718-bd84-f99c54fd98c1" src="https://github.com/user-attachments/assets/6158416e-3c61-47a8-b3e7-5d6250eebe3c" />

- OSINT Combine provides quick data visualization from local .csv files.
- The visualization is populated directly in the browser without needing third-party tools.
- As you load .csv files, it continuously adds the information to the network diagram.
- All data is managed from the client side; no information is processed through OSINT Combine servers.
- One example of using OSINT Combine is through domain name enumeration

## OPSEC 101

### Overview of OPSEC
- OPSEC is the process for mitigating vulnerabilities and safeguarding confidential, important, or classified data.
- OPSEC is a vital CPT process because if mistakes happen or there is a failure to observe the misuse of the information, there is the potential for seepage
- The ability to recognize, store, and comprehend essential elements of knowledge about one's environment is known as Situational Awareness (SA).
  - Simply put, SA entails being conscious of what is happening around you.
- To protect confidential, important, or classified data, CPT members must adhere to the following precautions:
  - Properly dispose of sensitive information (Operation Plans [OPLAN], memorandums, classified documents, etc.).
  - Do not share sensitive information to unauthorized personnel.
  - Avoid discussing sensitive information in public or unauthorized areas.
  - Do not send, post, and/or list information over the web.
  - Do not leave computers, tablets, and/or mobile phones unattended in public areas.

### OPSEC Terms
- Below are a number of terms and definitions commonly used when discussing OPSEC:
  - **Adversary**: An enemy who has the potential and motive to harm Department of Defense (DoD) activities or operations; also referred to as a threat.
  - **Countermeasure**: Employing equipment and/or tactics with the aim of reducing the operational effectiveness of an adversary's activities.
    - Anything that effectively negates or mitigates an adversary's ability to exploit vulnerabilities qualifies as a countermeasure.
  - **Critical information**: Specific information about friendly intentions, skills, or activities that adversaries need in order to prepare and function effectively in order to ensure failure or undesirable consequences for friendly mission accomplishment.
  - **Indicator**: Anything that draws attention to crucial details or provides an opponent with information regarding the environment or situation.
  - **OPSEC**: An empirical method that identifies preparation, processes, or operations to deny an adversary knowledge about objectives and capabilities that is usually unclassified.
    - Other security disciplines are not replaced by OPSEC; rather, they are supplemented by it.
  - **Risk**: A calculation of the insecurity of confidential information being compromised as a result of an adversary's exploitation.
  - **Risk analysis**: Specific vulnerabilities related to perceived or real-world security threat scenarios to evaluate the probability of sensitive information becoming compromised.
  - **Risk assessment**: A method of assessing the insecurity of information based on vulnerability to intelligence gathering and the severity of loss anticipated.
  - **Vulnerability**: An opportunity for an adversary to obtain sensitive information by exploiting a flaw. Anything that might give an adversary access to sensitive information.
- The OPSEC process includes the following five steps: (1) identification of critical information, (2) analysis of threats, (3) analysis of vulnerabilities, (4) assessment of risks, (5) application of appropriate countermeasures.

### HTTP vs HTTPS
- HTTPS is essentially HTTP using Transport Layer Security (TLS).
- The TLS protocol protects and encrypts information that is sent across the internet and combined with HTTP.
- A TLS connection ensures that the information sent between the server and web browser is encrypted.

<img width="1028" height="746" alt="bc13348b-8442-44e4-a5d1-a5e679cb518a" src="https://github.com/user-attachments/assets/a42f4daa-3da0-4292-ac81-23bfc3a791b6" />

### DNS over HTTPS
- DNS over HTTPS (DoH) serves as a solution to this concern.
- Widely adopted in 2020, DoH uses HTTPS essentially as an encrypted session layer for the DNS application data.
- In addition, there is DNS over TLS (DoT) that serves primarily the same function.
- Irrespective of which encryption solution is employed, encrypting DNS traffic limits the exposure of potentially mission-relevant information, and serves as an **OPSEC best practice**.

### Ensuring OPSEC with a VPN
- A VPN encapsulates and distributes network data over another network
- One use case for a VPN is to gain secure access to network services that should not be exposed to the public internet.
- An alternate use case is to encrypt traffic, transport it privately to another network, and then allow it to rejoin the public internet.
  - This serves to anonymize the traffic, or disassociate it from its point of origin.
  - By doing this, there is a reduced chance of mission-relevant data seeping publicly, and is an **OPSEC best practice**.
- For example, a CPT requires access to the internet, and has to rely on public Wireless Fidelity (WiFi).
- A VPN provides the extra layer of security and anonymity while allowing the CPT to fulfill its mission objectives. 

# MODULE 13

## The Traditional SIEM

### Siem Overview
<img width="2112" height="948" alt="b832dfc4-bc6d-43c6-b9ee-e9a27e8825db" src="https://github.com/user-attachments/assets/cd279529-833c-4c23-b59b-bed2a3bae86c" />

#### What is a SIEM?
- A **SIEM** is central to the modern Information Technology (IT) infrastructure
- It is a software solution that **aggregates and analyzes activity from many different resources**.
- A **SIEM** processes **data coming into and departing from networks and systems that are under an organization’s control**.
- Some SIEMs come with extensive functionality for data indexing, presentation, and alerts.
- However, the data ingested into a SIEM is only as useful as the accuracy of the data indices and filtering capabilities.
- The success of a SIEM is directly related to the administrator’s expertise with the accuracy of the data.
- A **SIEM** collects **data from hosts on the network** including: **switches**, **routers**, **servers**, Domain Controllers (**DC**), and **workstations**.
- SIEMs **store**, **normalize**, and **aggregate data analytics**, which allows analysts to **discover trends**, **detect threats**, and **enable organizations to investigate alerts**.

### Capabilities and Applications
- A SIEM has a range of capabilities that, when combined and integrated, offer **security monitoring and correlation** of multiple data sources
- The software allows security teams to gain insights on the attacker with threat rules derived from attacker Tactics, Techniques, and Procedures (TTP) and known Indicators of Compromise (IOC)
- The common capabilities and applications of a SIEM include:
  - Data Aggregation
    - SIEMs aggregate and consolidate data from across the enterprise’s network devices and endpoints.
    - Each node on the network continually processes large amounts of data. A SIEM is able to aggregate the data being processed.
  - Data Normalization
    - Aggregates and consolidates data from across enterprise's network devices
    - Aggregated data often has disparities and different fields.
    - Data normalization is the **process of structuring data commonly found in a relational database or SIEM**.
    - The data is structured in accordance with a series of normal forms.
    - The normal forms are filters designed to reduce data redundancy and improve data integrity.
    - The filters process the data by organizing it to avoid:
      - **Data Redundancy**: Unintentional occurrence of the same piece of data being held in two separate places
      - **Insertion Anomaly**: Inability to add data to the database or SIEM due to absence of other data
      - **Update Anomaly**: Data inconsistency that results from data redundancy
      - **Deletion Anomaly**: Unintended loss of data due to deletion of other data
  - Centralized Dashboard
    - SIEMs aggregate and consolidate data from across the enterprise’s network devices and endpoints into one centralized dashboard.
    - The dashboard is updated in realtime and allows an analyst to see a live snapshot of the enterprise.
  - Analysis and Security Event Correlation
    - SIEM enables analysts to access data and make decisions regarding potential signs of a data breach, threat, attack, or vulnerability.

### SIEM Security Monitoring
#### Use Cases
- An organization should leverage a SIEM’s capabilities to help in the following scenarios:
  - Anomaly Detection
    - Outliers and deviations from typical or expected behavior is an indicator of potentially Malicious Cyberspace Activity (MCA).
    - SIEM enables the ability to detect anomalous behaviors; these are behaviors out of the norm or unexpected.
    - Users take the information provided by the SIEM detection and further investigate the behavior.
    - For instance, the domain administrator on a network typically logs in at approximately 0800 and logs out at approximately 1600. The domain administrator follows this routine, give or take an hour, on a weekly basis.
    - However, recently the domain administrator's account was recorded as logging in and out at 0300. The SIEM collects the data regarding the anomaly and potentially alerts analysts.
  - Incident Response (IR)
    - SIEM does not provide IR alone; it enables analysts to see a real-time view of their network and make decisions regarding IR.
    - Analysts have a centralized view of machines and/or devices that may be affected. SIEM allows responders to query the network based on necessary requirements and make decisions quickly.
  - Insider Threat Preventions
    - Insider threats are a major vulnerability to organizations. Users who have access to the network need to be constantly monitored.
    - SIEM enables user monitoring; an analyst can create alerts and notifications based on anomalous or questionable activity that may occur on the network. Analysts are quickly able to identify the activity and make informed decisions.



